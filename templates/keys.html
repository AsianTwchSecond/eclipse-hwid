{% extends "base.html" %}
{% block content %}

<div class="card">
    <h2>Generate Keys</h2>

    <form method="POST" action="/keys">
        <label>Days</label>
        <input type="number" name="days" required>

        <label>Amount</label>
        <input type="number" name="amount" required>

        <button type="submit">Generate</button>
    </form>
</div>

{% if new_keys %}
<div class="card">
    <h3>New Keys Generated</h3>
    {% for k in new_keys %}
    <p>{{ k }}</p>
    {% endfor %}
</div>
{% endif %}

<div class="card">
    <h2>All Keys</h2>

    <ul style="list-style:none; padding-left:0;">
        {% for row in keys %}
        <li style="margin-bottom:20px;">

            <b>Key:</b> {{ row.key }}<br>
            <b>Expires:</b> {{ row.expires }}<br>
            <b>HWID:</b> {{ row.hwid if row.hwid else "None (Unused)" }}<br><br>

            <button onclick="copyScript('{{ row.key }}')">Copy Script</button>

            <a href="/deletekey/{{ row.key }}">
                <button style="background:#ff4c4c; margin-top:10px;">Delete</button>
            </a>

        </li>
        {% endfor %}
    </ul>
</div>

<script>
function copyScript(key) {
    let script = `_G.Key = "${key}"
loadstring(game:HttpGet("https://raw.githubusercontent.com/FwtysLuas/EclipseMeteor/refs/heads/main/Protected_8387035221277894.lua.txt"))()`;

    navigator.clipboard.writeText(script);
    alert("Copied script!");
}
</script>

{% endblock %}
